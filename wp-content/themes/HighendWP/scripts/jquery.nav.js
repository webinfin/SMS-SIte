!function(t,n,i){var e=function(e,s){this.elem=e,this.$elem=t(e),this.options=s,this.metadata=this.$elem.data("plugin-options"),this.$nav=this.$elem.find("a"),this.$win=t(n),this.sections={},this.didScroll=!0,this.$doc=t(i),this.docHeight=this.$doc.height()};e.prototype={defaults:{currentClass:"current",changeHash:!1,easing:"swing",filter:"",scrollSpeed:750,scrollOffset:0,scrollThreshold:.5,begin:!1,end:!1,scrollChange:!1},init:function(){var n=this;return n.config=t.extend({},n.defaults,n.options,n.metadata),""!==n.config.filter&&(n.$nav=n.$nav.filter(n.config.filter)),n.$nav.on("click.onePageNav",t.proxy(n.handleClick,n)),n.getPositions(),n.bindInterval(),n.$win.on("resize.onePageNav",t.proxy(n.getPositions,n)),this},adjustNav:function(t,n){t.$elem.find("."+t.config.currentClass).removeClass(t.config.currentClass),n.addClass(t.config.currentClass),jQuery("#hb-one-page-bullets").find(".current-item").removeClass("current-item");var i=n.find(">a").attr("href");jQuery("#hb-one-page-bullets li a").each(function(){jQuery(this).attr("href")==i&&jQuery(this).addClass("current-item")})},bindInterval:function(){var t,n=this;n.$win.on("scroll.onePageNav",function(){n.didScroll=!0}),n.t=setInterval(function(){t=n.$doc.height(),n.didScroll&&(n.didScroll=!1,n.scrollChange()),t!==n.docHeight&&(n.docHeight=t,n.getPositions())},250)},getHash:function(t){return t.attr("href").split("#")[1]},getPositions:function(){var n,i,e,s=this;s.$nav.each(function(){n=s.getHash(t(this)),e=t("#"+n),e.length&&(i=e.offset().top,s.sections[n]=Math.round(i)-s.config.scrollOffset)})},getSection:function(t){var n=null,i=null,e=Math.round(this.$win.height()*this.config.scrollThreshold),s=t>=this.docHeight-this.$win.height(),o=t+e;for(var a in this.sections)this.sections[a]>=this.sections[i||a]&&(i=a),this.sections[a]<o&&this.sections[a]>=this.sections[n||a]&&(n=a);return s?i:n},handleClick:function(i){var e=this,s=t(i.currentTarget),o=s.parent(),a="#"+e.getHash(s);o.hasClass(e.config.currentClass)||(e.config.begin&&e.config.begin(),e.adjustNav(e,o),e.unbindInterval(),t.scrollTo(a,e.config.scrollSpeed,{axis:"y",easing:e.config.easing,offset:{top:-e.config.scrollOffset},onAfter:function(){e.config.changeHash&&(n.location.hash=a),e.bindInterval(),e.config.end&&e.config.end()}})),"#undefined"!=a&&i.preventDefault()},scrollChange:function(){var t,n=this.$win.scrollTop(),i=this.getSection(n);null!==i&&(t=this.$elem.find('a[href$="#'+i+'"]').parent(),t.hasClass(this.config.currentClass)||(this.adjustNav(this,t),this.config.scrollChange&&this.config.scrollChange(t)))},unbindInterval:function(){clearInterval(this.t),this.$win.unbind("scroll.onePageNav")}},e.defaults=e.prototype.defaults,t.fn.onePageNav=function(t){return this.each(function(){new e(this,t).init()})}}(jQuery,window,document);